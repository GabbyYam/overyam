<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    Overyam
  
</title>

<meta name="description" content="On Your Mark">
<meta property="og:type" content="website">
<meta property="og:title" content="Overyam">
<meta property="og:url" content="https://gabbyyam.github.io/overyam/page/4/index.html">
<meta property="og:site_name" content="Overyam">
<meta property="og:description" content="On Your Mark">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="GabbyYam">
<meta name="twitter:card" content="summary">


  <link rel="alternative" href="/atom.xml" title="Overyam" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">



<link rel="stylesheet" href="/overyam/perfect-scrollbar/css/perfect-scrollbar.min.css">


<link rel="stylesheet" href="/overyam/styles/main.css">







<meta name="generator" content="Hexo 4.2.0"></head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/overyam/">Overyam</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/overyam/">Overyam</a></h1>
    
    <div class="info">
      <div class="content">
        
          <div class="description">On Your Mark</div>
        
        
          <div class="author">GabbyYam</div>
        
      </div>
      
        <div class="avatar">
          
            <a href="/about"><img src="https://cn.gravatar.com/avatar/35fef74d731255cd569c2c2b0b9e87e4?s=200"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li class="category-list-container">
                <a href="javascript:;">Category</a>
                
              </li>
            
          
            
              <li class="tag-list-container">
                <a href="javascript:;">Tag</a>
                
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">Archive</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/overyam/archives/2020/">2020</a><span class="archive-list-count">44</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="/overyam/" title="Homepage" external="false">Homepage</a>
              </li>
            
          
            
              <li>
                <a href="/overyam/archives" title="By Year" external="false">By Year</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="https://github.com/denjones/hexo-theme-chan" title="Chan" target="_blank" rel="noopener">Chan</a>
              </li>
            
          
            
              <li>
                <a href="https://github.com/denjones" title="Github" target="_blank" rel="noopener">Github</a>
              </li>
            
          
            
              <li>
                <a href="/overyam/atom.xml" title="RSS" external="false">RSS</a>
              </li>
            
          
        </ul>
      
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/overyam/2020/02/25/Operating%20system/Untitled/" >
  Operating system/Untitled
</a>

      </h3>
      

      <div class="article-info">
        <a href="/overyam/2020/02/25/Operating%20system/Untitled/"><span class="article-date">
  2020-02-25
</span>
</a>
        

        

      </div>
      <div class="article-entry">
        
          
        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/overyam/2020/02/25/NoSQL%20&%20Others/Redis-Basic/" >
  NoSQL &amp; Others/Redis-Basic
</a>

      </h3>
      

      <div class="article-info">
        <a href="/overyam/2020/02/25/NoSQL%20&%20Others/Redis-Basic/"><span class="article-date">
  2020-02-25
</span>
</a>
        

        

      </div>
      <div class="article-entry">
        
          <p>[TOC]</p>
<h1 id="Redis-Basic-Usage">Redis Basic Usage</h1>
<h2 id="string">string</h2>
<ul>
<li>
<p><code>string</code>是可变数组，实现类似于<code>ArrayList</code>，有冗余空间</p>
</li>
<li>
<p>小于1M，扩容加倍</p>
</li>
<li>
<p>大于1M，扩容1M</p>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--键值对</span></span><br><span class="line">&gt; set key </span><br><span class="line">&gt; get name</span><br><span class="line">&gt; exists name</span><br><span class="line">&gt; del name</span><br><span class="line"></span><br><span class="line"><span class="comment">--批量键值对</span></span><br><span class="line">&gt; mset name1 boy name2 girl name3 unknown</span><br><span class="line">&gt; mget name1 name2 name3</span><br><span class="line"></span><br><span class="line"><span class="comment">--过期策略</span></span><br><span class="line">&gt; expire key 1      --1s后过期</span><br><span class="line">&gt; setex key 1 value --设为value,1s过期</span><br><span class="line">&gt; setnx key value   --如果key存在就set，否则失败</span><br><span class="line"></span><br><span class="line"><span class="comment">--计数</span></span><br><span class="line">&gt; incr key     --value++</span><br><span class="line">&gt; incrby key k --value+=k      value=8bit</span><br></pre></td></tr></table></figure>
<h2 id="list">list</h2>
<ul>
<li>类似<code>LinkedList</code>，删改$O(1)$，索引$O(n)$</li>
<li>弹出最后一个元素后，list被删除</li>
<li>常用作异步队列</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--右进左出，队列</span></span><br><span class="line">&gt; rpush list value1 value2 value3</span><br><span class="line">&gt; llen list</span><br><span class="line">&gt; lpop</span><br><span class="line"></span><br><span class="line"><span class="comment">--左进右出，栈</span></span><br><span class="line">&gt; lpush list value1 value2 value3</span><br><span class="line">&gt; rpop</span><br></pre></td></tr></table></figure>
<h2 id="hash">hash</h2>
<ul>
<li>类似<code>HashMap</code>，数组+链表</li>
<li><code>value</code>只能为<code>string</code></li>
<li>渐进式<code>rehash</code></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; hset hash key "value" --创建return 1，更新 return 0</span><br><span class="line">&gt; hlen hash</span><br><span class="line">&gt; hget hash key</span><br><span class="line"></span><br><span class="line"><span class="comment">--批操作</span></span><br><span class="line">&gt; hmset hash key1 "value1" key2 "value2"</span><br><span class="line">&gt; hgetall hash</span><br><span class="line"></span><br><span class="line"><span class="comment">--计数</span></span><br><span class="line">&gt; hincr hash key</span><br><span class="line">&gt; hincrby hash key k     --同string</span><br></pre></td></tr></table></figure>
<h2 id="set">set</h2>
<ul>
<li>对标<code>HashSet</code>，无序键值对，<code>value</code>为<code>null</code></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; sadd set key      --已存在return 0,否则return index</span><br><span class="line">&gt; smembers set      --无序集合</span><br><span class="line">&gt; sismember set key --contains</span><br><span class="line">&gt; scard set			--长度</span><br><span class="line">&gt; spop set			--弹出一个</span><br></pre></td></tr></table></figure>
<h2 id="zset">zset</h2>
<ul>
<li><code>SortedSet</code>和<code>HashMap</code>的结合，<code>value</code>唯一，自带<code>权重</code></li>
<li>内部用<mark>跳跃列表</mark>实现</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; zadd zset key "value"</span><br><span class="line">&gt; zrange zset 0 -1    		--正序</span><br><span class="line">&gt; zrerange zset 0 -1  		--逆序</span><br><span class="line">&gt; zcard zset 				--size</span><br><span class="line">&gt; zscore zset "value"		--指定value的score</span><br><span class="line">&gt; zrank zset "value"		--指定value的排名</span><br><span class="line">&gt; zrangebyscore zset a b	--遍历指定score区间</span><br><span class="line">&gt; zrem zset "value"			--删除value</span><br></pre></td></tr></table></figure>
<h2 id="容器类的通用规则">容器类的通用规则</h2>
<p>容器类指的是：<code>list</code>,<code>set</code>,<code>hash</code>,<code>zset</code></p>
<ul>
<li>create if not exist</li>
<li>drop if no elements</li>
</ul>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/overyam/2020/02/25/NoSQL%20&%20Others/Redis-Application/" >
  NoSQL &amp; Others/Redis-Application
</a>

      </h3>
      

      <div class="article-info">
        <a href="/overyam/2020/02/25/NoSQL%20&%20Others/Redis-Application/"><span class="article-date">
  2020-02-25
</span>
</a>
        

        

      </div>
      <div class="article-entry">
        
          <p>[TOC]</p>
<h1 id="应用一：分布式锁（Distributed-Lock）">应用一：分布式锁（Distributed Lock）</h1>
<ul>
<li>
<p>**问题来源：**并发情况下，读取和修改保存这两步并不满足原子性，从而需要分布式锁来进行限制</p>
</li>
<li>
<p>**问题本质：**在Redis中占个坑，防止其他进程跑进来</p>
</li>
<li>
<pre><code class="language-sql">&gt; setnx lock ex k true --保证了expire和setnx的原子性,不适用于长任务
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- &#96;&#96;&#96;java</span><br><span class="line">  &#x2F;&#x2F;可重入锁</span><br><span class="line">  public class RedisWithReentrantLock &#123;</span><br><span class="line">      private ThreadLocal&lt;Map&gt; lockers &#x3D; new ThreadLocal&lt;&gt;();</span><br><span class="line">      private Jedis jedis;</span><br><span class="line">      public RedisWithReentrantLock(Jedis jedis) &#123;</span><br><span class="line">          this.jedis &#x3D; jedis;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      private boolean _lock(String key) &#123; 					&#x2F;&#x2F;加锁+自动过期</span><br><span class="line">          return jedis.set(key, &quot;&quot;, &quot;nx&quot;, &quot;ex&quot;, 5L) !&#x3D; null;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      private void _unlock(String key) &#123; 						&#x2F;&#x2F;解锁</span><br><span class="line">          jedis.del(key);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      private Map &lt;String, Integer&gt; currentLockers() &#123; 		</span><br><span class="line">          Map &lt;String, Integer&gt; refs &#x3D; lockers.get();</span><br><span class="line">          if (refs !&#x3D; null) &#123;</span><br><span class="line">              return refs;</span><br><span class="line">          &#125;</span><br><span class="line">          lockers.set(new HashMap&lt;&gt;());</span><br><span class="line">          return lockers.get();</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      public boolean lock(String key) &#123;</span><br><span class="line">          Map refs &#x3D; currentLockers();</span><br><span class="line">          Integer refCnt &#x3D; refs.get(key);</span><br><span class="line">          if (refCnt !&#x3D; null) &#123;</span><br><span class="line">              refs.put(key, refCnt + 1);</span><br><span class="line">              return true;</span><br><span class="line">          &#125;</span><br><span class="line">          boolean ok &#x3D; this._lock(key);</span><br><span class="line">          if (!ok) &#123;</span><br><span class="line">              return false;</span><br><span class="line">          &#125;</span><br><span class="line">          refs.put(key, 1);</span><br><span class="line">          return true;</span><br><span class="line">      &#125;</span><br><span class="line">      public boolean unlock(String key) &#123;</span><br><span class="line">          Map refs &#x3D; currentLockers();</span><br><span class="line">          Integer refCnt &#x3D; refs.get(key);</span><br><span class="line">          if (refCnt &#x3D;&#x3D; null) &#123;</span><br><span class="line">              return false;</span><br><span class="line">          &#125;</span><br><span class="line">          refCnt -&#x3D; 1;</span><br><span class="line">          if (refCnt &gt; 0) &#123;</span><br><span class="line">              refs.put(key, refCnt);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">              refs.remove(key);</span><br><span class="line">              this ._unlock(key);</span><br><span class="line">          &#125;</span><br><span class="line">          return true;</span><br><span class="line">      &#125;</span><br><span class="line">      public static void main(String[] args) &#123;</span><br><span class="line">          Jedis jedis &#x3D; new Jedis();</span><br><span class="line">          RedisWithReentrantLock redis &#x3D; new RedisWithReentrantLock(jedis);</span><br><span class="line">          System.out.println(redis.lock(&quot;codehole&quot;));</span><br><span class="line">          System.out.println(redis.lock(&quot;codehole&quot;));</span><br><span class="line">          System.out.println(redis.unlock(&quot;codehole&quot;));</span><br><span class="line">          System.out.println(redis.unlock(&quot;codehole&quot;));</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



</code></pre>
</li>
</ul>
<h1 id="应用二：延时队列（Delay-Queue）">应用二：延时队列（Delay Queue）</h1>
<ul>
<li>
<p>相比<code>rabbitMQ</code>等专业消息队列来说实现简单方便一些</p>
</li>
<li>
<p>直接使用<code>Redis</code>自带的<code>list</code>来实现</p>
</li>
<li>
<pre><code class="language-sql">
</code></pre>
</li>
</ul>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/overyam/2020/02/25/NoSQL%20&%20Others/Docker/" >
  NoSQL &amp; Others/Docker
</a>

      </h3>
      

      <div class="article-info">
        <a href="/overyam/2020/02/25/NoSQL%20&%20Others/Docker/"><span class="article-date">
  2020-02-25
</span>
</a>
        

        

      </div>
      <div class="article-entry">
        
          <h1 id="Docker-学习笔记">Docker 学习笔记</h1>
<p><strong>为什么需要Docker？</strong></p>
<p>为了解决开发环境和部署环境不一致而造成的不便</p>
<p><strong>为什么可以？</strong></p>
<p>打包成镜像，直接搬迁整套运行环境（软件，操作系统，各种jdk、mysql版本）</p>
<p><strong>和传统的虚拟机有什么区别？</strong></p>
<ul>
<li>
<p>虚拟机占用资源多，比较笨重</p>
</li>
<li>
<p>Linux容器不模拟完整的操作系统，只复刻需要的部分，启动快，更轻量</p>
</li>
<li>
<p>进程隔离，容器之间相互独立，耦合度更低</p>
</li>
</ul>
<p><strong>Docker的三要素：</strong></p>
<ul>
<li>镜像&amp;容器（类比 ：类和实例，容器是实例化的镜像）</li>
<li>仓库：集中存放镜像文件的场所</li>
</ul>
<h2 id="基本操作">基本操作</h2>
<ol>
<li>
<p>启动交互式容器&amp;关停</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -it xxx</span><br><span class="line"></span><br><span class="line">docker stop xxx</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>查看日志：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker log -t -f --tail n ID</span><br><span class="line"># t为时间，f为实时查看，tail n为后n条记录</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>进入容器内部&amp;无关闭退出&amp;关闭退出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker attach ID #进入容器内部</span><br><span class="line">Ctrl+p+q #快捷键无关闭退出</span><br><span class="line">exit #关闭退出</span><br><span class="line"></span><br><span class="line">docker exec -t ID [COMMAND] #直接在外部输入命令并返回结果</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>从docker容器复制文件到宿主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器ID container-path local-path</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Docker底层原理">Docker底层原理</h2>
<h3 id="基本描述：">基本描述：</h3>
<ul>
<li>UnionFS（联合文件系统）：多层叠加，逐级依赖</li>
<li>只有最外层可写，内层只读</li>
<li>实现资源共享</li>
<li>容器可持久化</li>
</ul>
<p><strong>容器与主机  -v（可直接创建文件夹） 挂载后能够共享文件数据</strong></p>
<p>如果inspect 容器设定中，<mark>volumeRW</mark>为<strong>true</strong> ：无论容器是否开启都可以自由读写<br>
<strong>否则，容器只可读不可写</strong></p>
<h3 id="容器的数据传递：">容器的数据传递：</h3>
<p><strong>几个要点：</strong></p>
<ul>
<li>文件之间相互继承会导致数据共享，子类的改动将会使父类也改动</li>
<li>两类同样继承于一个父类，当父类被删除时，子类间依然满足数据共享</li>
</ul>
<p><strong>结论：容器之间配置信息的传递，数据卷的生命周期一直持续到没有容器使用他为止</strong></p>
<h3 id="DockerFile：">DockerFile：</h3>
<p><mark>基础镜像：scratch（所有的镜像的父类）</mark></p>
<h4 id="保留字：">保留字：</h4>
<ol>
<li>
<p><strong>DockerFile生成镜像：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.写好dockerfile</span><br><span class="line">2.docker build -f dockerfilePath -t isoName .  #注意最后的&quot;.&quot;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>FROM</strong>：继承镜像，相当于include,import</p>
</li>
<li>
<p><strong>MAINTAINER</strong>：作者姓名及邮箱</p>
</li>
<li>
<p><strong>RUN</strong>： 容器构建时需要执行的命令</p>
</li>
<li>
<p><strong>WORKDIR</strong>：创建容器后，终端默认登陆进来的工作目录</p>
</li>
<li>
<p><strong>EXPOSE</strong>:容器对外暴露的端口号</p>
</li>
<li>
<p><strong>ENV</strong>:镜像构建过程中设置环境变量</p>
</li>
<li>
<p><strong>ADD</strong>:将宿主机的文件拷贝进入镜像并自动解压缩</p>
</li>
<li>
<p><strong>COPY</strong>:同上，但不能自动解压缩</p>
</li>
<li>
<p><strong>VOLUME</strong>:容器数据卷，用于数据保存和持久化</p>
</li>
<li>
<p><strong>CMD</strong>:指定容器启动时要执行的命令，但多条CMD的情况下只有最后一条生效</p>
</li>
<li>
<p><strong>ENTRYPOINT</strong>:同上，但是支持多条命令</p>
</li>
<li>
<p><strong>ONBUILD</strong>:父镜像被继承后，需要执行的命令</p>
</li>
</ol>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/overyam/2020/02/25/Java%20basic/Collections-Overview/" >
  Java basic/Collections-Overview
</a>

      </h3>
      

      <div class="article-info">
        <a href="/overyam/2020/02/25/Java%20basic/Collections-Overview/"><span class="article-date">
  2020-02-25
</span>
</a>
        

        

      </div>
      <div class="article-entry">
        
          <p>[TOC]</p>
<h1 id="Interface">Interface</h1>
<h2 id="Traversing-Collections（集合遍历）">Traversing Collections（集合遍历）</h2>
<blockquote>
<p>什么是集合类？集合类不是简单的用来存储元素的，而是为了方便地取出存储的元素</p>
</blockquote>
<h3 id="Aggregate-Operations（聚合操作）">Aggregate Operations（聚合操作）</h3>
<blockquote>
<p>In JDK 8 and later, the preferred method of iterating over a collection is to obtain a stream and perform aggregate operations on it. Aggregate operations are often used in conjunction with lambda expressions to make programming more expressive, using less lines of code. The following code sequentially iterates through a collection of shapes and prints out the red objects:</p>
</blockquote>
<p>jdk1.8开始，<mark>更推荐用 stream + 聚合操作</mark>的方式配合 <mark>lambda表达式</mark> 进行</p>
<p><strong>优点是，让程序可读性更强</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myShapesCollection.stream()</span><br><span class="line">.filter(e -&gt; e.getColor() == Color.RED)         <span class="comment">//过滤器，筛掉不需要的元素</span></span><br><span class="line">.forEach(e -&gt; System.out.println(e.getName())); <span class="comment">//forEach遍历</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Likewise, you could easily request a parallel stream, which might make sense if the collection is large enough and your computer has enough cores:</p>
</blockquote>
<p><strong>parallelStream:</strong></p>
<ul>
<li>无序性</li>
<li>拆分子问题，分配到多个子线程，再将子问题的结果合并</li>
<li>中间操作均为懒操作，即只有当需要他的结果时，那个线程才会被启用</li>
<li>不要使用有状态的<code>lambda</code>表达式，这会导致每次执行的结果大概率不同</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myShapesCollection.parallelStream()             <span class="comment">//并行管道，适合多核处理器+超大容量集合</span></span><br><span class="line">.filter(e -&gt; e.getColor() == Color.RED)</span><br><span class="line">.forEach(e -&gt; System.out.println(e.getName()));</span><br></pre></td></tr></table></figure>
<blockquote>
<p>There are many different ways to collect data with this API. For example, you might want to convert the elements of a <code>Collection</code> to <code>String</code> objects, then join them, separated by commas:</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String joined = elements.stream()			</span><br><span class="line">.map(Object::toString)						<span class="comment">//类型转换</span></span><br><span class="line">.collect(Collectors.joining(<span class="string">", "</span>));         <span class="comment">//切割拼接</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Or perhaps sum the salaries of all employees:</p>
</blockquote>
<p><strong>归约 &amp; 合并：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Averager</span> <span class="keyword">implements</span> <span class="title">IntConsumer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">average</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span> ? ((<span class="keyword">double</span>) total)/count : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; total += i; count++; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">combine</span><span class="params">(Averager other)</span> </span>&#123;</span><br><span class="line">        total += other.total;</span><br><span class="line">        count += other.count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>collect Method <code>(Averager::new , Averager::accept , Averager::combine)</code>
<ul>
<li><code>supplier</code>:提供一个存储结果的类的构造器</li>
<li><code>accumulator</code>：累加器，操作<code>supplier</code>中的数据</li>
<li><code>combiner</code>：组合器，将两个<code>supplier</code>中的对应字段</li>
<li><code>Collectors</code>:直接用 <code>Collector</code> 提供的方法</li>
</ul>
</li>
<li>reduce Method <code>(0,(a,b) -&gt; a+b)</code> 初值+累加操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> total = employees.stream()</span><br><span class="line">.collect(Collectors.summingInt(Employee::getSalary))); <span class="comment">//求和</span></span><br></pre></td></tr></table></figure>
<h3 id="for-each-Construct（加强型for循环）">for-each Construct（加强型for循环）</h3>
<p>不必多说</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(Integer e:c)&#123;</span><br><span class="line">    System.out.println(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Iterators（迭代器遍历）">Iterators（迭代器遍历）</h3>
<p>不必多说</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Iterator i = c.iterator();</span><br><span class="line"><span class="keyword">while</span>(i.hasNext())&#123;</span><br><span class="line">    System.out.println(i.next());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Collection-Interface-Bulk-Operations（批量操作）">Collection Interface Bulk Operations（批量操作）</h2>
<ul>
<li><code>containsAll</code> — returns <code>true</code> if the target <code>Collection</code> contains all of the elements in the specified <code>Collection</code>.</li>
<li><code>addAll</code> — adds all of the elements in the specified <code>Collection</code> to the target <code>Collection</code>.</li>
<li><code>removeAll</code> — removes from the target <code>Collection</code> all of its elements that are also contained in the specified <code>Collection</code>.</li>
<li><code>retainAll</code> — removes from the target <code>Collection</code> all its elements that are <em>not</em> also contained in the specified <code>Collection</code>. That is, it retains only those elements in the target <code>Collection</code> that are also contained in the specified <code>Collection</code>.</li>
<li><code>clear</code> — removes all elements from the <code>Collection</code>.</li>
</ul>
<h2 id="Collection-Interface-Array-Operations（数组操作）">Collection Interface Array Operations（数组操作）</h2>
<p>For example, suppose that <code>c</code> is a <code>Collection</code>. The following snippet dumps the contents of <code>c</code> into a newly allocated array of <code>Object</code> whose length is identical to the number of elements in <code>c</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object[] a = c.toArray();</span><br></pre></td></tr></table></figure>
<p>Suppose that <code>c</code> is known to contain only strings (perhaps because <code>c</code> is of type <code>Collection</code>). The following snippet dumps the contents of <code>c</code> into a newly allocated array of <code>String</code> whose length is identical to the number of elements in <code>c</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String[] a = c.toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br></pre></td></tr></table></figure>
<h1 id="Implementations">Implementations</h1>
<p>Implementations are the data objects used to store collections, which implement the interfaces described in <a href="https://docs.oracle.com/javase/tutorial/collections/interfaces/index.html" target="_blank" rel="noopener">the Interfaces section</a>. This lesson describes the following kinds of implementations:</p>
<ul>
<li><strong>General-purpose implementations</strong> are the most commonly used implementations, designed for everyday use. They are summarized in the table titled General-purpose-implementations.</li>
<li><strong>Special-purpose implementations</strong> are designed for use in special situations and display nonstandard performance characteristics, usage restrictions, or behavior.</li>
<li><strong>Concurrent implementations</strong> are designed to support high concurrency, typically at the expense of single-threaded performance. These implementations are part of the <code>java.util.concurrent</code> package.</li>
<li><strong>Wrapper implementations</strong> are used in combination with other types of implementations, often the general-purpose ones, to provide added or restricted functionality.</li>
<li><strong>Convenience implementations</strong> are mini-implementations, typically made available via static factory methods, that provide convenient, efficient alternatives to general-purpose implementations for special collections (for example, singleton sets).</li>
<li><strong>Abstract implementations</strong> are skeletal implementations that facilitate the construction of custom implementations — described later in the <a href="https://docs.oracle.com/javase/tutorial/collections/custom-implementations/index.html" target="_blank" rel="noopener">Custom Collection Implementations</a> section. An advanced topic, it’s not particularly difficult, but relatively few people will need to do it.</li>
</ul>
<h2 id="General-purpose-Implementations-常规实现类">General-purpose Implementations(常规实现类)</h2>
<table>
<thead>
<tr>
<th>Interfaces</th>
<th>Hash table Implementations</th>
<th>Resizable array Implementations</th>
<th>Tree Implementations</th>
<th>Linked list Implementations</th>
<th>Hash table + Linked list Implementations</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Set</code></td>
<td><code>HashSet</code></td>
<td></td>
<td><code>TreeSet</code></td>
<td></td>
<td><code>LinkedHashSet</code></td>
</tr>
<tr>
<td><code>List</code></td>
<td></td>
<td><code>ArrayList</code></td>
<td></td>
<td><code>LinkedList</code></td>
<td></td>
</tr>
<tr>
<td><code>Queue</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>Deque</code></td>
<td></td>
<td><code>ArrayDeque</code></td>
<td></td>
<td><code>LinkedList</code></td>
<td></td>
</tr>
<tr>
<td><code>Map</code></td>
<td><code>HashMap</code></td>
<td></td>
<td><code>TreeMap</code></td>
<td></td>
<td><code>LinkedHashMap</code></td>
</tr>
</tbody>
</table>
<h2 id="Set-Implementations（Set实现类）">Set Implementations（Set实现类）</h2>
<h3 id="General-Purpose-Set-Implementations">General-Purpose Set Implementations</h3>
<ul>
<li>HashSet：HashSet，非线程安全</li>
<li>TreeSet ：有序集合，非线程安全</li>
<li>LinkedHashSet ：记录插入顺序的HashSet</li>
</ul>
<h3 id="Special-Purpose-Set-Implementations">Special-Purpose Set Implementations</h3>
<ul>
<li>EnumSet ：高性能的EnumSet</li>
<li>CopyOnWriteArraySet : 并发包中的Set，线程安全，用于并发场景</li>
</ul>
<h2 id="List-Implementations（List实现类）">List Implementations（List实现类）</h2>
<h3 id="General-Purpose-Set-Implementations-v2">General-Purpose Set Implementations</h3>
<ul>
<li>ArrayList ：基于数组的List，非线程安全</li>
<li>LinkedList：基于链表的List，非线程安全</li>
</ul>
<h3 id="Special-Purpose-Set-Implementations-v2">Special-Purpose Set Implementations</h3>
<ul>
<li>
<p>CopyOnWriteArrayList：适合维护事件处理型List，即修改不频繁，但是遍历和潜在时间消耗大的情形</p>
<blockquote>
<p>This implementation is well suited to maintaining event-handler lists, in which change is infrequent, and traversal is frequent and potentially time-consuming.</p>
</blockquote>
</li>
</ul>
<h2 id="Map-Implementations（Map实现类）">Map Implementations（Map实现类）</h2>
<h3 id="General-Purpose-Map-Implementations">General-Purpose Map Implementations</h3>
<ul>
<li>HashMap：线程不安全</li>
<li>TreeMap：Key有序的Map，线程不安全</li>
<li>LinkedHashMap：记录插入顺序的HashMap</li>
</ul>
<h3 id="Special-Purpose-Map-Implementations">Special-Purpose Map Implementations</h3>
<ul>
<li>EnumMap：高性能的EnumMap</li>
<li>WeakHashMap：专门存放弱引用的HashMap</li>
<li>IdentityHashMap：基于HashTable，看不懂，用不到吧？</li>
</ul>
<h3 id="Concurrent-Map-Implementations">Concurrent Map Implementations</h3>
<ul>
<li>ConcurrentMap：高并发、高性能的HashTable，</li>
</ul>
<h2 id="Queue-Implementations（Queue实现类）">Queue Implementations（Queue实现类）</h2>
<h3 id="General-Purpose-Queue-Implementations">General-Purpose Queue Implementations</h3>
<ul>
<li>PriorityQueue：基于Heap的优先队列，默认为<code>nature ordering</code></li>
</ul>
<h3 id="Concurrent-Queue-Implementations">Concurrent Queue Implementations</h3>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/LinkedBlockingQueue.html" target="_blank" rel="noopener"><code>LinkedBlockingQueue</code></a> — an optionally bounded FIFO blocking queue backed by linked nodes</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayBlockingQueue.html" target="_blank" rel="noopener"><code>ArrayBlockingQueue</code></a> — a bounded FIFO blocking queue backed by an array</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/PriorityBlockingQueue.html" target="_blank" rel="noopener"><code>PriorityBlockingQueue</code></a> — an unbounded blocking priority queue backed by a heap</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/DelayQueue.html" target="_blank" rel="noopener"><code>DelayQueue</code></a> — a time-based scheduling queue backed by a heap</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/SynchronousQueue.html" target="_blank" rel="noopener"><code>SynchronousQueue</code></a> — a simple rendezvous mechanism that uses the <code>BlockingQueue</code> interface</li>
</ul>
<p>In JDK 7, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TransferQueue.html" target="_blank" rel="noopener"><code>TransferQueue</code></a> is a specialized <code>BlockingQueue</code> in which code that adds an element to the queue has the option of waiting (blocking) for code in another thread to retrieve the element. <code>TransferQueue</code> has a single implementation:</p>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/LinkedTransferQueue.html" target="_blank" rel="noopener"><code>LinkedTransferQueue</code></a> — an unbounded <code>TransferQueue</code> based on linked nodes</li>
</ul>

        
      </div>
    </div>

  
    </div>
  



  <div class="pagination">
    <a class="extend prev" rel="prev" href="/overyam/page/3/">Prev</a><a class="page-number" href="/overyam/">1</a><a class="page-number" href="/overyam/page/2/">2</a><a class="page-number" href="/overyam/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/overyam/page/5/">5</a><a class="page-number" href="/overyam/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/overyam/page/9/">9</a><a class="extend next" rel="next" href="/overyam/page/5/">Next</a>
  </div>




          <div class="main-footer">
  
    © 2020 Overyam - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>


  
<link rel="stylesheet" href="/overyam/PhotoSwipe/photoswipe.css">

  
<link rel="stylesheet" href="/overyam/PhotoSwipe/default-skin/default-skin.css">


  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  
<script src="/overyam/PhotoSwipe/photoswipe.js"></script>

  
<script src="/overyam/PhotoSwipe/photoswipe-ui-default.js"></script>




<script src="/overyam/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>


<script src="/overyam/scripts/main.js"></script>


</body>
</html>
